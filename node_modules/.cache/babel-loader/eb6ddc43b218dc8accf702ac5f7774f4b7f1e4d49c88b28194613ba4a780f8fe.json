{"ast":null,"code":"import _regenerator from \"C:/Users/DELL/OneDrive/Documentos/agenda-medicao/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _asyncToGenerator from \"C:/Users/DELL/OneDrive/Documentos/agenda-medicao/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar API_BASE_URL = 'http://localhost:5000/api';\nexport var authService = {\n  // Login\n  login: function login(email, password) {\n    return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee() {\n      var response, error, data;\n      return _regenerator().w(function (_context) {\n        while (1) switch (_context.n) {\n          case 0:\n            _context.n = 1;\n            return fetch(\"\".concat(API_BASE_URL, \"/auth/login\"), {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: JSON.stringify({\n                email: email,\n                password: password\n              })\n            });\n          case 1:\n            response = _context.v;\n            if (response.ok) {\n              _context.n = 3;\n              break;\n            }\n            _context.n = 2;\n            return response.json();\n          case 2:\n            error = _context.v;\n            throw new Error(error.error || 'Erro ao fazer login');\n          case 3:\n            _context.n = 4;\n            return response.json();\n          case 4:\n            data = _context.v;\n            // Salvar token e usuário no localStorage\n            localStorage.setItem('token', data.token);\n            localStorage.setItem('user', JSON.stringify(data.user));\n            return _context.a(2, data);\n        }\n      }, _callee);\n    }))();\n  },\n  // Logout\n  logout: function logout() {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n  },\n  // Get current user\n  getCurrentUser: function getCurrentUser() {\n    var userStr = localStorage.getItem('user');\n    return userStr ? JSON.parse(userStr) : null;\n  },\n  // Get token\n  getToken: function getToken() {\n    return localStorage.getItem('token');\n  },\n  // Check if user is authenticated\n  isAuthenticated: function isAuthenticated() {\n    return !!localStorage.getItem('token');\n  },\n  // Check if user is admin\n  isAdmin: function isAdmin() {\n    var user = this.getCurrentUser();\n    return user && user.role === 'admin';\n  },\n  // Get user info\n  getUserInfo: function getUserInfo() {\n    var _this = this;\n    return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee2() {\n      var token, response, user;\n      return _regenerator().w(function (_context2) {\n        while (1) switch (_context2.n) {\n          case 0:\n            token = _this.getToken();\n            if (token) {\n              _context2.n = 1;\n              break;\n            }\n            return _context2.a(2, null);\n          case 1:\n            _context2.n = 2;\n            return fetch(\"\".concat(API_BASE_URL, \"/auth/me\"), {\n              headers: {\n                'Authorization': \"Bearer \".concat(token)\n              }\n            });\n          case 2:\n            response = _context2.v;\n            if (response.ok) {\n              _context2.n = 3;\n              break;\n            }\n            _this.logout();\n            return _context2.a(2, null);\n          case 3:\n            _context2.n = 4;\n            return response.json();\n          case 4:\n            user = _context2.v;\n            localStorage.setItem('user', JSON.stringify(user));\n            return _context2.a(2, user);\n        }\n      }, _callee2);\n    }))();\n  }\n};","map":{"version":3,"names":["API_BASE_URL","authService","login","email","password","_asyncToGenerator","_regenerator","m","_callee","response","error","data","w","_context","n","fetch","concat","method","headers","body","JSON","stringify","v","ok","json","Error","localStorage","setItem","token","user","a","logout","removeItem","getCurrentUser","userStr","getItem","parse","getToken","isAuthenticated","isAdmin","role","getUserInfo","_this","_callee2","_context2"],"sources":["C:/Users/DELL/OneDrive/Documentos/agenda-medicao/src/services/auth.js"],"sourcesContent":["const API_BASE_URL = 'http://localhost:5000/api';\r\n\r\nexport const authService = {\r\n  // Login\r\n  async login(email, password) {\r\n    const response = await fetch(`${API_BASE_URL}/auth/login`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({ email, password }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.error || 'Erro ao fazer login');\r\n    }\r\n\r\n    const data = await response.json();\r\n    \r\n    // Salvar token e usuário no localStorage\r\n    localStorage.setItem('token', data.token);\r\n    localStorage.setItem('user', JSON.stringify(data.user));\r\n    \r\n    return data;\r\n  },\r\n\r\n  // Logout\r\n  logout() {\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('user');\r\n  },\r\n\r\n  // Get current user\r\n  getCurrentUser() {\r\n    const userStr = localStorage.getItem('user');\r\n    return userStr ? JSON.parse(userStr) : null;\r\n  },\r\n\r\n  // Get token\r\n  getToken() {\r\n    return localStorage.getItem('token');\r\n  },\r\n\r\n  // Check if user is authenticated\r\n  isAuthenticated() {\r\n    return !!localStorage.getItem('token');\r\n  },\r\n\r\n  // Check if user is admin\r\n  isAdmin() {\r\n    const user = this.getCurrentUser();\r\n    return user && user.role === 'admin';\r\n  },\r\n\r\n  // Get user info\r\n  async getUserInfo() {\r\n    const token = this.getToken();\r\n    if (!token) return null;\r\n\r\n    const response = await fetch(`${API_BASE_URL}/auth/me`, {\r\n      headers: {\r\n        'Authorization': `Bearer ${token}`,\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      this.logout();\r\n      return null;\r\n    }\r\n\r\n    const user = await response.json();\r\n    localStorage.setItem('user', JSON.stringify(user));\r\n    return user;\r\n  }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}